{"version":3,"file":"index.js","names":["addon","require","getAddonReleaseVersion","mask","sourceImage","xOffset","yOffset","cb","constructor","throwError","call","bitmap","data","getWidth","getHeight","ensureInteger","cppCallbackWrapper","err","plugin","maskAsync","wrapAsync"],"sources":["../src/index.ts"],"sourcesContent":["import { throwError } from \"@jimp/utils\";\nimport { Mask } from \"@jimp/plugin-mask\";\nimport { ImageCallback } from \"@jimp/core\";\nimport {\n  ensureInteger,\n  getAddonReleaseVersion,\n  cppCallbackWrapper,\n  AsyncPlugin,\n  wrapAsync,\n} from \"@jimp-native/utils-ts\";\nimport Jimp from \"jimp\";\n\nconst addon = require(`../build/${getAddonReleaseVersion()}/plugin-mask-napi.node`);\n\nconst mask = function (\n  sourceImage: Jimp,\n  xOffset = 0,\n  yOffset = 0,\n  cb?: ImageCallback<AsyncPlugin<Mask>>\n) {\n  if (!(sourceImage instanceof this.constructor)) {\n    return throwError.call(this, \"sourceImage must be a Jimp image\");\n  }\n\n  try {\n    addon.mask(\n      sourceImage.bitmap.data,\n      sourceImage.getWidth(),\n      sourceImage.getHeight(),\n      this.bitmap.data,\n      this.getWidth(),\n      this.getHeight(),\n      ensureInteger(xOffset),\n      ensureInteger(yOffset),\n      cppCallbackWrapper(this, cb)\n    );\n\n    return this;\n  } catch (err) {\n    return throwError.call(this, err, cb);\n  }\n};\n\nconst plugin: () => AsyncPlugin<Mask> = () => ({\n  mask,\n  maskAsync: wrapAsync(mask),\n});\n\nexport default plugin;\n"],"mappings":";;;;;;AAAA;AAGA;AASA,IAAMA,KAAK,GAAGC,OAAO,oBAAa,IAAAC,+BAAsB,GAAE,4BAAyB;AAEnF,IAAMC,IAAI,GAAG,SAAPA,IAAI,CACRC,WAAiB,EAIjB;EAAA,IAHAC,OAAO,uEAAG,CAAC;EAAA,IACXC,OAAO,uEAAG,CAAC;EAAA,IACXC,EAAqC;EAErC,IAAI,EAAEH,WAAW,YAAY,IAAI,CAACI,WAAW,CAAC,EAAE;IAC9C,OAAOC,iBAAU,CAACC,IAAI,CAAC,IAAI,EAAE,kCAAkC,CAAC;EAClE;EAEA,IAAI;IACFV,KAAK,CAACG,IAAI,CACRC,WAAW,CAACO,MAAM,CAACC,IAAI,EACvBR,WAAW,CAACS,QAAQ,EAAE,EACtBT,WAAW,CAACU,SAAS,EAAE,EACvB,IAAI,CAACH,MAAM,CAACC,IAAI,EAChB,IAAI,CAACC,QAAQ,EAAE,EACf,IAAI,CAACC,SAAS,EAAE,EAChB,IAAAC,sBAAa,EAACV,OAAO,CAAC,EACtB,IAAAU,sBAAa,EAACT,OAAO,CAAC,EACtB,IAAAU,2BAAkB,EAAC,IAAI,EAAET,EAAE,CAAC,CAC7B;IAED,OAAO,IAAI;EACb,CAAC,CAAC,OAAOU,GAAG,EAAE;IACZ,OAAOR,iBAAU,CAACC,IAAI,CAAC,IAAI,EAAEO,GAAG,EAAEV,EAAE,CAAC;EACvC;AACF,CAAC;AAED,IAAMW,MAA+B,GAAG,SAAlCA,MAA+B;EAAA,OAAU;IAC7Cf,IAAI,EAAJA,IAAI;IACJgB,SAAS,EAAE,IAAAC,kBAAS,EAACjB,IAAI;EAC3B,CAAC;AAAA,CAAC;AAAC,eAEYe,MAAM;AAAA;AAAA"}