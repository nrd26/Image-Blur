{"version":3,"file":"index.js","names":["throwError","ensureInteger","getAddonReleaseVersion","cppCallbackWrapper","wrapAsync","addon","require","blit","sourceImage","xOffset","yOffset","sourceX","sourceY","sourceW","sourceH","cb","constructor","call","getWidth","getHeight","bitmap","data","err","plugin","blitAsync"],"sources":["../src/index.ts"],"sourcesContent":["import { throwError } from \"@jimp/utils\";\nimport { Blit } from \"@jimp/plugin-blit\";\nimport { ImageCallback } from \"@jimp/core\";\nimport {\n  ensureInteger,\n  getAddonReleaseVersion,\n  cppCallbackWrapper,\n  AsyncPlugin,\n  wrapAsync,\n} from \"@jimp-native/utils-ts\";\nimport Jimp from \"jimp\";\n\nconst addon = require(`../build/${getAddonReleaseVersion()}/plugin-blit-napi.node`);\n\nconst blit = function (\n  sourceImage: Jimp,\n  xOffset: number,\n  yOffset: number,\n  sourceX?: number | ImageCallback<AsyncPlugin<Blit>>,\n  sourceY?: number,\n  sourceW?: number,\n  sourceH?: number,\n  cb?: ImageCallback<AsyncPlugin<Blit>>\n) {\n  if (!(sourceImage instanceof this.constructor)) {\n    return throwError.call(this, \"sourceImage must be a Jimp image\");\n  }\n\n  if (typeof sourceX === \"function\") {\n    cb = sourceX;\n    sourceX = 0;\n  }\n\n  sourceX = sourceX || 0;\n  sourceY = sourceY || 0;\n  sourceW = sourceW || sourceImage.getWidth();\n  sourceH = sourceH || sourceImage.getHeight();\n\n  try {\n    addon.blit(\n      sourceImage.bitmap.data,\n      sourceImage.getWidth(),\n      sourceImage.getHeight(),\n      this.bitmap.data,\n      this.getWidth(),\n      this.getHeight(),\n      ensureInteger(xOffset),\n      ensureInteger(yOffset),\n      ensureInteger(sourceX),\n      ensureInteger(sourceY),\n      ensureInteger(sourceW),\n      ensureInteger(sourceH),\n      cppCallbackWrapper(this, cb)\n    );\n\n    return this;\n  } catch (err) {\n    return throwError.call(this, err, cb);\n  }\n};\n\nconst plugin: () => AsyncPlugin<Blit> = () => ({\n  blit,\n  blitAsync: wrapAsync(blit),\n});\n\nexport default plugin;\n"],"mappings":"AAAA,SAASA,UAAU,QAAQ,aAAa;AAGxC,SACEC,aAAa,EACbC,sBAAsB,EACtBC,kBAAkB,EAElBC,SAAS,QACJ,uBAAuB;AAG9B,IAAMC,KAAK,GAAGC,OAAO,oBAAaJ,sBAAsB,EAAE,4BAAyB;AAEnF,IAAMK,IAAI,GAAG,SAAPA,IAAI,CACRC,WAAiB,EACjBC,OAAe,EACfC,OAAe,EACfC,OAAmD,EACnDC,OAAgB,EAChBC,OAAgB,EAChBC,OAAgB,EAChBC,EAAqC,EACrC;EACA,IAAI,EAAEP,WAAW,YAAY,IAAI,CAACQ,WAAW,CAAC,EAAE;IAC9C,OAAOhB,UAAU,CAACiB,IAAI,CAAC,IAAI,EAAE,kCAAkC,CAAC;EAClE;EAEA,IAAI,OAAON,OAAO,KAAK,UAAU,EAAE;IACjCI,EAAE,GAAGJ,OAAO;IACZA,OAAO,GAAG,CAAC;EACb;EAEAA,OAAO,GAAGA,OAAO,IAAI,CAAC;EACtBC,OAAO,GAAGA,OAAO,IAAI,CAAC;EACtBC,OAAO,GAAGA,OAAO,IAAIL,WAAW,CAACU,QAAQ,EAAE;EAC3CJ,OAAO,GAAGA,OAAO,IAAIN,WAAW,CAACW,SAAS,EAAE;EAE5C,IAAI;IACFd,KAAK,CAACE,IAAI,CACRC,WAAW,CAACY,MAAM,CAACC,IAAI,EACvBb,WAAW,CAACU,QAAQ,EAAE,EACtBV,WAAW,CAACW,SAAS,EAAE,EACvB,IAAI,CAACC,MAAM,CAACC,IAAI,EAChB,IAAI,CAACH,QAAQ,EAAE,EACf,IAAI,CAACC,SAAS,EAAE,EAChBlB,aAAa,CAACQ,OAAO,CAAC,EACtBR,aAAa,CAACS,OAAO,CAAC,EACtBT,aAAa,CAACU,OAAO,CAAC,EACtBV,aAAa,CAACW,OAAO,CAAC,EACtBX,aAAa,CAACY,OAAO,CAAC,EACtBZ,aAAa,CAACa,OAAO,CAAC,EACtBX,kBAAkB,CAAC,IAAI,EAAEY,EAAE,CAAC,CAC7B;IAED,OAAO,IAAI;EACb,CAAC,CAAC,OAAOO,GAAG,EAAE;IACZ,OAAOtB,UAAU,CAACiB,IAAI,CAAC,IAAI,EAAEK,GAAG,EAAEP,EAAE,CAAC;EACvC;AACF,CAAC;AAED,IAAMQ,MAA+B,GAAG,SAAlCA,MAA+B;EAAA,OAAU;IAC7ChB,IAAI,EAAJA,IAAI;IACJiB,SAAS,EAAEpB,SAAS,CAACG,IAAI;EAC3B,CAAC;AAAA,CAAC;AAEF,eAAegB,MAAM"}